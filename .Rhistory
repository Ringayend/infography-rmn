getwd()
setwd(dir = "/Volumes/laure.marchal\$/git/infography-rmn")
setwd(dir = "/Volumes/laure.marchal/git/infography-rmn")
setwd(dir = "/Volumes")
setwd(dir = "/Volumes/laure.marchal$/")
setwd(dir = "/Volumes/laure.marchal$/git")
setwd(dir = "/Volumes/laure.marchal$/git/infography-rmn/")
library(readxl)
Base_Equipement <- read_excel("/Volumes/laure.marchal$/git/infography-rmn/Base_Equipement.xlsx")
View(Base_Equipement)
colNames<-colnames(Base_Equipement)
filterColumns<-grep("Q2+|Q6+|Q8+|Q9+|Q11+|Q12+|Q13+|Q14+|Q15+|Q16+|Q17+|Q19+|Q24+|Q25+|Q29+|Q30+|Q31+|Q32+|Q33+|Q34+|Q35+|Q36+|Q37+|Q38+|Q39+|Q40+|Q41+|Q42+|Q43+|Q44+|Q58+|Q59+|Q60+|Q61+|Q62+|Q63+|Q64+|Q65+|Q66+|Q67+|Q68+|Q69+|Q70+|Q71+|Q72+|Q73+|Q74+|Q75+|Q76+|Q82+|Q84+|Q85+|Q86+|Q87+|Q88+|Q89+|Q96+|Q97+|Q98+|Q99+|Q100+|Q101+|Q102+|Q103+|Q104+|Q105+|Q114+|Q117+", colNames, perl = FALSE, value = TRUE)
Base_Equipement_Filtered<-Base_Equipement[filterColumns]
print(Base_Equipement_Filtered)
print("Filtering columns: done.")
tabModAge <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`> 49 = 1,]
plusde49 <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`> 49,]
moinsde49 <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`<= 49,]
plusde49 <- Base_Equipement_Filtered$`Q58 [1]`=1
plusde49 <- plusde49[plusde49$`Q58 [1]`= 1,]
plusde49 <- plusde49['Q58 [1]'= 1,]
plusde49 <- plusde49['Q58 [1]'= 1]
tabModAge <- plusde49$`Q58 [1]` = 1
tabModAge <- plusde49[plusde49$`Q58 [1]`] =1
tabModAge <- plusde49[plusde49$`Q58 [1]` = 1,]
tabModAge <- plusde49[plusde49$`Q58 [1]` <- 1,]
View(tabModAge)
tabModAge <- plusde49[plusde49$`Q58 [1]` = 1,]
tabModAge <- plusde49[plusde49$`Q58 [1]` = 1]
plusde49$`Q58 [1]`
View(plusde49)
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`= 0,]
View(moinsde49)
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`= 0]
View(moinsde49)
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`<- 0]
moinsde49 <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`<= 49,]
View(Base_Equipement_Filtered)
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`=0]
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`=0,]
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`,]=0
View(moinsde49)
moinsde49 <- moinsde49[moinsde49$`Q58 [1]`,] <- 0
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
array[i,index]<-0
return(array)
}
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
array[i,index]<-0
}
return(array)
}
moinsde49 <- cleanAgeFait(moinsde49,'Q58 [1]')
View(moinsde49)
tabModAge <- plusde49 + moinsde49
?Ops.data.frame()
tabModAge <- data.frame(plusde49,moinsde49)
tabModage <- plusde49[moinsde49]
tabModage <- plusde49[,moinsde49]
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] <= 49){
array[i,index]<-0
}
else{
array[i,index]<-1
}
}
return(array)
}
tabModAge <- cleanAgeFait(Base_Equipement_Filtered,'Q58 [1]')
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if((array[i,index] <= 49) == TRUE){
array[i,index]<-0
}
else{
array[i,index]<-1
}
}
return(array)
}
tabModAge <- cleanAgeFait(Base_Equipement_Filtered,'Q58 [1]')
bite
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] <= 49){
array[i,index]<-0
}
else{
array[i,index]<-1
}
}
return(array)
}
tabModAge <- cleanAgeFait(Base_Equipement_Filtered,'Q58 [1]')
tab <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`=="NA",]
View(tab)
tab <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`=="NA",2195]
tab <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1],2195]
tab <- Base_Equipement_Filtered[Base_Equipement_Filtered$`Q58 [1]`,2195]
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] == "NA"){
array[i,index]<-0
}
else if(array[i,index] <= 49){
array[i,index]<-0
}
else{
array[i,index]<-1
}
}
return(array)
}
tabModAge <- cleanAgeFait(Base_Equipement_Filtered,'Q58 [1]')
cleanAgeFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(is.na(array[i,index])){
array[i,index]<-0
}
else if(array[i,index] <= 49){
array[i,index]<-0
}
else{
array[i,index]<-1
}
}
return(array)
}
tabModAge <- cleanAgeFait(Base_Equipement_Filtered,'Q58 [1]')
View(tabModAge)
remove(plusde49)
remove(moinsde49)
remove(tab)
table(tabModAge$`Q58 [1]`,tabModAge$`Q97 [1]`)
cleanAccidentFait<-function(array,index){
n<-nrow(array)
array[,index]<-as.character(array[,index])
for(i in 1:n){
if(array[i,index]=="1"){
array[i,index]<-"Oui"
}
else if(array[i,index]=="0"){
array[i,index]<-"Non"
}
}
return(array)
}
tabModAge <- cleanAccidentFait(tabModAge,'Q97 [1]')
table(tabModAge$`Q58 [1]`,tabModAge$`Q97 [1]`)
tabContingenceAgeAccident <- table(tabModAge$`Q58 [1]`,tabModAge$`Q97 [1]`)
save(tabContingenceAgeAccident,"Tab_contingence_Age/Accident.RData")
save(tabContingenceAgeAccident,"Tab_contingence_Age_Accident.RData")
save(tabContingenceAgeAccident,file = "Tab_contingence_Age_Accident.RData")
chisq.test(tabContingenceAgeAccident)
install.packages("FactoMineR")
library(FactoMineR)
CA(tabContingenceAgeAccident)
View(Base_Equipement_Filtered)
cleanCSPFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Etudiants" | array[i,index] ==  "En recherche d'emploi"){
array[i,index]<-"sans emplois"
}
else if(array[i,index] ==  "Employés"){
array[i,index]<-"employes"
}
else if(array[i,index] ==  "Cadres"){
array[i,index]<-"cadres"
}
else if(array[i,index] ==  "Ouvriers"){
array[i,index]<-"ouvriers"
}
else if(array[i,index] ==  "Retraités"){
array[i,index]<-"retraites"
}
else{
array[i,index]<-"autres"
}
}
return(array)
}
tabModCSP <- cleanCSPFait(Base_Equipement_Filtered,'Q11 [1]')
cleanCSPFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Etudiants" | array[i,index] ==  "En recherche d'emploi"){
array[i,index]<-"sans emplois"
}
else if(array[i,index] ==  "Employés"){
array[i,index]<-"employes"
}
else if(array[i,index] ==  "Cadres"){
array[i,index]<-"cadres"
}
else if(array[i,index] ==  "Ouvriers"){
array[i,index]<-"ouvriers"
}
else if(array[i,index] ==  "Retraités"){
array[i,index]<-"retraites"
}
else if(array[i,index] ==  "Chefs d'entrepirses de 10 salariés de plus"){
array[i,index]<-"patrons"
}
else{
array[i,index]<-"autres"
}
}
return(array)
}
tabModCSP <- cleanCSPFait(Base_Equipement_Filtered,'Q11 [1]')
View(tabModCSP)
tabContingenceCSPAccident <- table(tabModCSP$`Q11 [1]`,tabModCSP$`Q97 [1]`)
tabContingenceCSPAccident
cleanAccidentFait<-function(array,index){
n<-nrow(array)
array[,index]<-as.character(array[,index])
for(i in 1:n){
if(array[i,index]=="1"){
array[i,index]<-"Oui"
}
else if(array[i,index]=="0"){
array[i,index]<-"Non"
}
}
return(array)
}
tabModCSP
tabModCSP <- cleanAccidentFait(tabModCSP,'Q97 [1]')
tabContingenceCSPAccident <- table(tabModCSP$`Q11 [1]`,tabModCSP$`Q97 [1]`)
tabContingenceCSPAccident
save(tabContingenceCSPAccident,file = "Tab_contingence_CSP_Accident.RData")
chisq.test(tabContingenceCSPAccident)
View(Base_Equipement_Filtered)
cleanToutJourFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Oui" ){
array[i,index]<-"conducteurDeTouLesJours"
}
}
return(array)
}
cleanSemaineFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Oui" ){
array[i,index]<-"conducteurSemaine"
}
}
return(array)
}
cleanMoisFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Oui" ){
array[i,index]<-"conducteurMois"
}
}
return(array)
}
cleanAnFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Oui" ){
array[i,index]<-"conducteurAn"
}
}
return(array)
}
cleanProFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] ==  "Oui" ){
array[i,index]<-"conducteurTrajetPro"
}
}
return(array)
}
tab <- cleanToutJourFait(Base_Equipement_Filtered,'Q13 [1]')
tab <- cleanSemaineFait(Base_Equipement_Filtered,'Q14 [1]')
tab <- cleanMoisFait(Base_Equipement_Filtered,'Q14 [1]')
remove(tab)
tab <- cleanToutJourFait(Base_Equipement_Filtered,'Q13 [1]')
tab <- cleanSemaineFait(Base_Equipement_Filtered,'Q14 [1]')
tab <- cleanMoisFait(Base_Equipement_Filtered,'Q15 [1]')
tab <- cleanAnFait(Base_Equipement_Filtered,'Q16 [1]')
tab <- cleanProFait(Base_Equipement_Filtered,'Q17 [1]')
View(tab)
cleanToutJourFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] =="Oui"){
array[i,index]<-"conducteurDeTousLesJours"
}
}
return(array)
}
cleanSemaineFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] =="Oui"){
array[i,index]<-"conducteurSemaine"
}
}
return(array)
}
cleanMoisFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] =="Oui"){
array[i,index]<-"conducteurMois"
}
}
return(array)
}
cleanAnFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] =="Oui"){
array[i,index]<-"conducteurAn"
}
}
return(array)
}
cleanProFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index] =="Oui"){
array[i,index]<-"conducteurTrajetPro"
}
}
return(array)
}
tab <- cleanToutJourFait(Base_Equipement_Filtered,'Q13 [1]')
tab <- cleanSemaineFait(tab,'Q14 [1]')
View(tab)
tab <- cleanMoisFait(tab,'Q15 [1]')
tab <- cleanAnFait(tab,'Q16 [1]')
tab <- cleanProFait(tab,'Q17 [1]')
View(tab)
View(tabModAge)
newTab <- tab$`Q13 [1]`[tab$`Q13 [1]`=="Non"] <- tab$`Q14 [1]`
newTab <- tab$`Q13 [1]`[tab$`Q13 [1]`=="Non"] <- tab$`Q14 [1]`[tab$`Q14 [1]`]
remove(tab)
remove(newtab)
remove(newTab)
cleanExpAnFait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]=="Oui"){
array[i,index]<-"1an"
}
}
return(array)
}
cleanExpPlus2Fait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]=="Oui"){
array[i,index]<-"2-4ans"
}
}
return(array)
}
cleanExpPlus5Fait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]=="Oui"){
array[i,index]<-"5-9ans"
}
}
return(array)
}
cleanExpPlus10Fait<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]=="Oui"){
array[i,index]<-"10ans et +"
}
}
return(array)
}
tab <- cleanAnFait(Base_Equipement_Filtered,'Q30 [1]')
tab <- cleanExpAnFait(Base_Equipement_Filtered,'Q30 [1]')
tab <- cleanExpPlus2Fait(tab,'Q31 [1]')
tab <- cleanExpPlus5Fait(tab,'Q32 [1]')
tab <- cleanExpPlus10Fait(tab,'Q33 [1]')
View(tab)
newTab <- tab[tab$`Q30 [1]`=="Non"] <- tab$`Q31 [1]`
cleanExpFait<-function(array,index,nindex){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]=="Non"){
array[i,index]<-array[i,nindex]
}
}
return(array)
}
View(tab)
newTab <- cleanExpFait(tab,'Q30 [1]','Q31 [1]')
View(newTab)
newTab <- cleanExpFait(tab,'Q30 [1]','Q32 [1]')
newTab <- cleanExpFait(tab,'Q30 [1]','Q33 [1]')
newTab <- cleanExpFait(tab,'Q30 [1]','Q31 [1]')
newTab <- cleanExpFait(tab,'Q30 [1]','Q32 [1]')
newTab <- cleanExpFait(tab,'Q30 [1]','Q31 [1]')
newTab <- cleanExpFait(newTab,'Q30 [1]','Q32 [1]')
newTab <- cleanExpFait(newTab,'Q30 [1]','Q33 [1]')
newTab <- cleanAccidentFait(newTab$`Q97 [1]`)
newTab <- cleanAccidentFait(newTab,'Q97 [1]')
tabContingenceExpAccident <- table(newTab$`Q30 [1]`,newTab$`Q97 [1]`)
tabContingenceExpAccident
save(tabContingenceExpAccident,file = "Tableau_contingence_Experience_accident.RData")
save(tabContingenceExpAccident,file = "Tableau_contingence_Experience_accident.RData")
save(tabContingenceExpAccident,file = "Tab_contingence_Exp_accident.RData")
getwd()
setwd("/Volumes/laure.marchal$/git/infography-rmn")
save(tabContingenceExpAccident,file = "Tab_contingence_Exp_accident.RData")
save(tabContingenceCSPAccident,file = "Tab_contingence_CSP_accident.RData")
chisq.test(tabContingenceExpAccident)
