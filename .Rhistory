install.packages("FactoMineR")
getwd()
setwd(dir = "C:/Users/Laure/git/infography-rmn/")
library(FactoMineR)
PCA()
load("C:/Users/Laure/git/infography-rmn/Base_Equipement_propre.RData")
View(Base_Equipement_1)
summary(Base_Equipement_1$`Q12 [1]`)
moinsde5000 <- Base_Equipement_1[Base_Equipement_1$`Q12 [1]` <= 5000,]
View(moinsde5000)
cleanModKilo<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(array[i,index]<=5000){
array[i,index]<-"moinsde5000"
}
else if(array[i,index]<=10000){
array[i,index]<-"moinsde10000"
}
else if(array[i,index]<=15000){
array[i,index]<-"moinsde15000"
}
else if(array[i,index]>15000){
array[i,index]<-"plusde15000"
}
}
return(array)
}
tabModKilo <- cleanModKilo(Base_Equipement_1,'Q12 [1]')
cleanModKilo<-function(array,index){
n<-nrow(array)
for(i in 1:n){
if(is.na(array[i,index])){array[i,index]<-"autres"}
if(array[i,index]<=5000){
array[i,index]<-"moinsde5000"
}
else if(array[i,index]<=10000){
array[i,index]<-"moinsde10000"
}
else if(array[i,index]<=15000){
array[i,index]<-"moinsde15000"
}
else if(array[i,index]>15000){
array[i,index]<-"plusde15000"
}
}
return(array)
}
tabModKilo <- cleanModKilo(Base_Equipement_1,'Q12 [1]')
View(tabModKilo)
remove(moinsde5000)
table(tabModKilo$`Q12 [1]`,tabModKilo$`Q97 [1]`)
cleanAccidentFait<-function(array,index){
n<-nrow(array)
array[,index]<-as.character(array[,index])
for(i in 1:n){
if(array[i,index]=="1"){
array[i,index]<-"Oui"
}
else if(array[i,index]=="0"){
array[i,index]<-"Non"
}
}
return(array)
}
tabModKilo <- cleanAccidentFait(tabModKilo,'Q97 [1]')
tabContingenceKiloACC <- table(tabModKilo$`Q12 [1]`,tabModKilo$`Q97 [1]`)
tabContingenceKiloACC
CA(tabContingenceKiloACC)
chisq.test(tabContingenceKiloACC)
save(tabContingenceKiloACC,file = "tabContingenceKiloAcc.RData")
afc <- CA(tabContingenceKiloACC)
afc
plot(afc)
plot(afc$col$coord)
afc$col$contrib
plot(afc,1)
